###  Gateway IBKR

pgrep -fl Gateway               # should show 1 (or 2) running process(es)
# whichever port scheme you chose:
lsof -nP -iTCP:4001 -sTCP:LISTEN  # live SSL
lsof -nP -iTCP:7496 -sTCP:LISTEN  # live non-SSL

/Users/dmitry_v/Library/LaunchAgents:

com.ibkr.gateway.health.plist
com.ibkr.gateway.paper.plist
com.ibkr.gateway.live.plist
launchctl bootout  gui/$(id -u)/com.ibkr.gateway.live  2>/dev/null || true  # terminate service
launchctl bootstrap gui/$(id -u) ~/Library/LaunchAgents/com.ibkr.gateway.live.plist  #load the service
launchctl list | grep -E 'com\.ibkr\.gateway\.health|ibkr'  # list running services + check specific one health

plutil -lint ~/Library/LaunchAgents/com.optionstrader.mirror.live.am.plist  # Check plist file structure

Logs: /Users/dmitry_v/Library/Logs/ibkr*

###

# Wake up : pmset
pmset -g sched # scheduled awaiks
sudo pmset schedule cancelall  # That removes all one-time scheduled events (e.g. pmset schedule wake ...)
sudo pmset repeat cancel       # clear any repeating events (if you set one with pmset repeat)

Logs: tail -n 80 /var/log/second-wake/second-wake.log   # Check wakeing history
sudo launchctl kickstart -k system/com.you.secondwake # “As root, restart the system-level LaunchDaemon named com.you.secondwake right now, even if it’s already running.”

###

#  Mirror Live and Paper IBKR accounts

launchctl unload ~/Library/LaunchAgents/com.optionstrader.mirror.live.am.plist
launchctl load -w ~/Library/LaunchAgents/com.optionstrader.mirror.live.am.plist

launchctl unload ~/Library/LaunchAgents/com.optionstrader.mirror.live.pm.plist
launchctl load -w ~/Library/LaunchAgents/com.optionstrader.mirror.live.pm.plist

launchctl unload ~/Library/LaunchAgents/com.optionstrader.mirror.paper.am.plist
launchctl load -w ~/Library/LaunchAgents/com.optionstrader.mirror.paper.am.plist

launchctl unload ~/Library/LaunchAgents/com.optionstrader.mirror.paper.pm.plist
launchctl load -w ~/Library/LaunchAgents/com.optionstrader.mirror.paper.pm.plist


###  Bash

set -euo pipefail



########    UI   ###########
# Your Node is too old. create-vite@8 requires Node ≥ 20.19 or ≥ 22.12, but you’re on Node 16.2.0.
# That’s why you see the stripVTControlCharacters error (that export doesn’t exist in Node 16).

nvm install 22
nvm use 22
nvm alias default 22

# verify
node -v   # should be v22.x
npm -v    # then optionally update npm:
npm i -g npm@latest

(venv) dmitry_v@Dmitrys-MacBook-Pro optionsTrader % npm -v
10.9.4
(venv) dmitry_v@Dmitrys-MacBook-Pro optionsTrader % npm i -g npm@latest

removed 27 packages, and changed 77 packages in 3s

28 packages are looking for funding
  run `npm fund` for details
(venv) dmitry_v@Dmitrys-MacBook-Pro optionsTrader % npm -v
11.6.2

VITE v7.1.11  ready in 676 ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
  ➜  press h + enter to show help

cd ui  # Important to be in right directory !!!
npm run dev	Start local dev server (hot reload).
npm run build	Create production build in /dist.
npm run preview	Preview that production build locally (on port 4173).

***  Node   ***
node -v            # you'll see v16.2.0 right now
nvm use 22         # or: nvm use   # (reads .nvmrc = 22.21.0)
node -v            # should now be v22.21.0
npm -v             # should be 11.x








